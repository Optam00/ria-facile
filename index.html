<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- SEO -->
    <title>RIA Facile - comprendre et appliquer le r√®glement IA (AI act, IA act, RIA)</title>
    <meta name="description" content="RIA Facile propose plusieurs outils pour vous aider dans votre mise en conformit√© : outil de consultation du RIA, quiz, actualit√©s, etc." />
    <meta name="keywords" content="RIA, AI Act, r√®glement IA, intelligence artificielle, conformit√©, Europe" />
    <meta property="og:title" content="RIA Facile - comprendre et appliquer le r√®glement IA (AI act, IA act, RIA)" />
    <meta property="og:description" content="RIA Facile propose plusieurs outils pour vous aider dans votre mise en conformit√© : outil de consultation du RIA, quiz, actualit√©s, etc." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://ria-facile.com" />

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7QV1MCQ879"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      // Attendre le consentement avant d'activer Google Analytics
      gtag('consent', 'default', {
        'analytics_storage': 'denied'
      });

      gtag('config', 'G-7QV1MCQ879', {
        'cookie_flags': 'SameSite=None;Secure'
      });
    </script>
  </head>
  <body>
    <div id="root"></div>
    <!-- Script qui s'ex√©cute AVANT React pour nettoyer la session si d√©connexion explicite -->
    <script>
      // V√©rifier le flag de d√©connexion explicite AVANT que Supabase ne charge
      (function() {
        const explicitLogout = localStorage.getItem('explicit_logout') === 'true';
        const logoutTimestamp = localStorage.getItem('explicit_logout_timestamp');
        
        if (explicitLogout && logoutTimestamp) {
          const logoutTime = parseInt(logoutTimestamp, 10);
          const daysSinceLogout = (Date.now() - logoutTime) / (1000 * 60 * 60 * 24);
          
          if (daysSinceLogout < 7) {
            // D√©connexion explicite r√©cente : nettoyer TOUTES les cl√©s Supabase
            console.log('üîí D√©connexion explicite d√©tect√©e, nettoyage de la session...');
            
            // Nettoyer toutes les cl√©s possibles de Supabase
            const keysToRemove = [
              'ria_admin_session',
              'ria_public_read',
            ];
            
            // Trouver le projectRef depuis les cl√©s existantes ou nettoyer toutes les cl√©s sb-*
            Object.keys(localStorage).forEach(key => {
              if (key.startsWith('sb-') || 
                  key.startsWith('supabase.') ||
                  (key.includes('supabase') && !key.includes('explicit_logout')) ||
                  (key.includes('auth') && !key.includes('explicit_logout'))) {
                keysToRemove.push(key);
              }
            });
            
            // Supprimer les doublons
            const uniqueKeys = [...new Set(keysToRemove)];
            
            uniqueKeys.forEach(key => {
              try {
                localStorage.removeItem(key);
              } catch (e) {
                console.warn('Impossible de supprimer', key, e);
              }
            });
            
            console.log('‚úÖ Session nettoy√©e,', uniqueKeys.length, 'cl√©s supprim√©es');
          } else {
            // Flag trop ancien, le supprimer
            localStorage.removeItem('explicit_logout');
            localStorage.removeItem('explicit_logout_timestamp');
          }
        }
      })();
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html> 